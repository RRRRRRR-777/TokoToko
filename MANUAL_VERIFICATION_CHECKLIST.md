# リファクタリング・改善対応 手動検証チェックリスト

**作成日**: 2025-01-27  
**対象**: NavigationBarStyleManager導入とUI統一改善のデグレッション検証  
**検証者**: _______________  
**検証日**: _______________

## 📋 検証概要

以下の項目は単体テストでカバーできない部分のため、手動での検証が必要です。  
各項目をチェックし、問題がある場合は詳細を記録してください。

---

## 🎨 1. Navigation Bar外観統一性検証

### 1.1 基本外観確認
- [ ] **ホーム画面**: Navigation Barが統一されたベージュ背景色（BackgroundColor）で表示される
- [ ] **散歩履歴画面**: Navigation Barが統一されたベージュ背景色で表示される  
- [ ] **設定画面**: Navigation Barが統一されたベージュ背景色で表示される
- [ ] **アプリ情報画面**: Navigation Barが統一されたベージュ背景色で表示される
- [ ] **位置情報設定画面**: Navigation Barが統一されたベージュ背景色で表示される
- [ ] **ポリシー画面**: Navigation Barが統一されたベージュ背景色で表示され、シャドウが非表示

**問題があった場合の詳細記録**:
```
画面名: _______________
問題: _______________
期待値: _______________
実際の値: _______________
```

### 1.2 テキスト色統一性確認
- [ ] **全画面共通**: Navigation Barのタイトルテキストが黒色で表示される
- [ ] **全画面共通**: 戻るボタン等のアクセントカラーが黒色で表示される
- [ ] **全画面共通**: Navigation Bar上のボタンテキストが黒色で表示される

**問題があった場合の詳細記録**:
```
画面名: _______________
要素: _______________
問題: _______________
```

---

## 🌓 2. ダークモード・ライトモード統一性検証

### 2.1 モード切り替え動作確認
**検証手順**:
1. iOS設定 → 画面表示と明るさ → ライトモード に設定
2. アプリを起動し、各画面の外観を確認
3. iOS設定 → 画面表示と明るさ → ダークモード に設定  
4. アプリに戻り、各画面の外観を確認
5. 外観が変化せず一貫していることを確認

### 2.2 各画面での統一性確認
**ライトモード**:
- [ ] ホーム画面: 背景色とNavigation Barが統一されている
- [ ] 散歩履歴画面: 背景色とNavigation Barが統一されている
- [ ] 設定画面: 背景色とNavigation Barが統一されている  
- [ ] アプリ情報画面: 背景色とNavigation Barが統一されている
- [ ] 位置情報設定画面: 背景色とNavigation Barが統一されている

**ダークモード**:
- [ ] ホーム画面: ライトモードと同じ外観（色の変化なし）
- [ ] 散歩履歴画面: ライトモードと同じ外観（色の変化なし）
- [ ] 設定画面: ライトモードと同じ外観（色の変化なし）
- [ ] アプリ情報画面: ライトモードと同じ外観（色の変化なし） 
- [ ] 位置情報設定画面: ライトモードと同じ外観（色の変化なし）

**問題があった場合の詳細記録**:
```
モード: ライト / ダーク
画面名: _______________
問題: _______________
スクリーンショット添付: [ ]
```

---

## 🔄 3. 画面遷移時の外観維持確認

### 3.1 タブ間遷移
**検証手順**: 各タブを順次タップし、外観が一貫していることを確認
- [ ] おでかけタブ → おさんぽタブ: 外観一貫性維持
- [ ] おさんぽタブ → 設定タブ: 外観一貫性維持  
- [ ] 設定タブ → おでかけタブ: 外観一貫性維持

### 3.2 階層画面遷移
**検証手順**: Navigation Linkによる画面遷移で外観が維持されることを確認
- [ ] 設定 → このアプリについて: 遷移後も外観統一
- [ ] 設定 → 位置情報設定: 遷移後も外観統一
- [ ] 設定 → プライバシーポリシー: 遷移後も外観統一（シャドウ非表示）
- [ ] 設定 → 利用規約: 遷移後も外観統一（シャドウ非表示）

**問題があった場合の詳細記録**:
```
遷移パス: _______________
問題: _______________
発生タイミング: 遷移直後 / しばらく後
```

---

## 📱 4. iOS版別互換性検証

### 4.1 iOS 15での動作確認
**対象デバイス**: iOS 15.x シミュレーターまたは実機

- [ ] **Navigation Bar外観**: 統一された背景色とテキスト色で表示される
- [ ] **リスト背景**: ScrollContentBackgroundModifierが正しく動作する
- [ ] **画面遷移**: 外観設定が正しく引き継がれる
- [ ] **アプリ全体**: クラッシュや表示崩れがない

### 4.2 iOS 16+での動作確認  
**対象デバイス**: iOS 16.x 以降のシミュレーターまたは実機

- [ ] **Navigation Bar外観**: 統一された背景色とテキスト色で表示される
- [ ] **リスト背景**: .scrollContentBackground(.hidden)が正しく動作する
- [ ] **画面遷移**: 外観設定が正しく引き継がれる
- [ ] **アプリ全体**: クラッシュや表示崩れがない

**問題があった場合の詳細記録**:
```
iOS バージョン: _______________
デバイス: シミュレーター / 実機
画面名: _______________
問題: _______________
```

---

## ⚡ 5. パフォーマンス・安定性検証

### 5.1 位置情報設定画面の再帰処理確認
**検証手順**:
1. 位置情報設定画面を表示する
2. 画面の応答性を確認する（重くないか）
3. Debug Consoleで再帰処理のログを確認する（デバッグビルドの場合）

- [ ] **画面表示**: 遅延やフリーズがない
- [ ] **背景色適用**: 統一された背景色が適切に表示される
- [ ] **Debug Log**: 再帰処理の実行時間が合理的範囲内（通常<10ms）

**Debug Logサンプル**:
```
LocationAccuracySettingsView: 背景色再帰適用完了 - 実行時間: X.XXXms, 最大深度: X
```

### 5.2 メモリリーク確認
**検証手順**:
1. 各画面を繰り返し表示・非表示する（10回程度）
2. メモリ使用量が異常に増加しないことを確認
3. 画面遷移後にメモリが適切に解放されることを確認

- [ ] **メモリ使用量**: 画面表示での異常な増加がない  
- [ ] **画面遷移**: バック操作後にメモリが解放される
- [ ] **長時間使用**: 連続使用でメモリリークが発生しない

---

## 🔍 6. リファクタリング前後の機能比較

### 6.1 Navigation Bar設定機能
**検証ポイント**: リファクタリング前と同等の外観が維持されていることを確認

- [ ] **背景色**: リファクタリング前と同じベージュ背景色
- [ ] **テキスト色**: リファクタリング前と同じ黒テキスト  
- [ ] **シャドウ**: ポリシー画面でのシャドウ非表示が維持されている
- [ ] **その他**: 特殊な外観設定が失われていない

### 6.2 画面固有の動作
**検証ポイント**: 各画面の独自機能が正常に動作することを確認

- [ ] **WalkListView**: セグメントコントロールの外観と動作
- [ ] **AppInfoView**: リスト表示とスクロール動作
- [ ] **PolicyView**: 大きなタイトル表示と長文スクロール
- [ ] **SettingsView**: リスト項目の表示と操作
- [ ] **LocationAccuracySettingsView**: 設定変更と権限状態表示

---

## 📝 7. 総合評価

### 7.1 デグレッション評価
- [ ] **重大な問題**: なし
- [ ] **軽微な問題**: なし  
- [ ] **改善点**: なし
- [ ] **全体評価**: 合格 / 要修正

### 7.2 問題の重要度分類
**見つかった問題を重要度別に記録**:

**🔴 重大 (リリース阻害)**:
```
問題1: _______________
問題2: _______________
```

**🟡 軽微 (修正推奨)**:
```  
問題1: _______________
問題2: _______________
```

**🔵 改善 (将来対応)**:
```
問題1: _______________
問題2: _______________
```

### 7.3 検証完了署名
```
検証者: _______________
検証完了日時: _______________
総合判定: 合格 / 条件付き合格 / 要修正
コメント: _______________
```

---

## 🛠️ 8. トラブルシューティング

### よくある問題と対処法

**問題**: Navigation Barの色が統一されていない  
**対処法**: アプリを一度終了して再起動する。それでも直らない場合は単体テストの実行結果を確認

**問題**: ダークモードで外観が変化する  
**対処法**: iOS設定でのモード切り替え後、アプリをフォアグラウンドに戻す操作を確認

**問題**: 画面遷移で外観が崩れる  
**対処法**: 遷移方法（タブタップ vs NavigationLink）を確認し、両方で問題が発生するか検証

**問題**: パフォーマンスの低下  
**対処法**: Debug Consoleでログを確認し、再帰処理の実行時間をチェック

---

**📞 問題が解決しない場合**: 開発チームまでご連絡ください